!function(){"use strict";var a=angular.module("btorfs.multiselect",["btorfs.multiselect.templates"]);a.getRecursiveProperty=function(a,b){return b.split(".").reduce(function(a,b){return a?a[b]:null},a)},a.directive("multiselect",["$filter","$document","$log",function(b,c,d){return{restrict:"AE",scope:{options:"=",displayProp:"@",idProp:"@",searchLimit:"=?",selectionLimit:"=?",showSelectAll:"=?",showUnselectAll:"=?",showSearch:"=?",searchFilter:"=?",disabled:"=?ngDisabled",labels:"=?",showTooltip:"=?",placeholder:"@"},require:"ngModel",templateUrl:"multiselect.html",link:function(e,f,g,h){e.selectionLimit=e.selectionLimit||0,e.searchLimit=e.searchLimit||25,e.searchFilter="",e.resolvedOptions=[],"function"!=typeof e.options&&(e.resolvedOptions=e.options),"undefined"!=typeof g.disabled&&(e.disabled=!0);var i=function(a){f[0].contains(a.target)||e.$apply(function(){e.open=!1})};c.on("click",i);var j=function(){h.$viewValue?(e.selectedOptions=e.resolvedOptions.filter(function(a){for(var b=e.getId(a),c=0;c<h.$viewValue.length;c++){var d=e.getId(h.$viewValue[c]);if(b===d)return!0}return!1}),e.unselectedOptions=e.resolvedOptions.filter(function(a){return e.selectedOptions.indexOf(a)<0})):(e.selectedOptions&&(e.selectedOptions=[]),e.unselectedOptions=e.resolvedOptions.slice())};e.toggleDropdown=function(){e.open=!e.open,e.resolvedOptions=e.options,j()},h.$render=function(){j()},h.$viewChangeListeners.push(function(){j()}),h.$isEmpty=function(a){return!a||0===a.length};var k=e.$watch("selectedOptions",function(){h.$setViewValue(angular.copy(e.selectedOptions))},!0);e.$on("$destroy",function(){c.off("click",i),k&&k()}),e.getButtonText=function(){if(e.selectedOptions&&1===e.selectedOptions.length)return e.getDisplay(e.selectedOptions[0]);if(!(e.selectedOptions&&e.selectedOptions.length>1))return e.labels&&e.labels.select?e.labels.select:e.placeholder||"Select";var a=angular.isDefined(e.selectedOptions)?e.selectedOptions.length:0;if(0===a)return e.labels&&e.labels.select?e.labels.select:e.placeholder||"Select";try{return b("trueList")(e.selectedOptions,e.displayProp)}catch(b){return a+" "+(e.labels&&e.labels.itemsSelected?e.labels.itemsSelected:"selected")}},e.selectAll=function(){e.selectedOptions=e.resolvedOptions.slice(),e.unselectedOptions=[]},e.unselectAll=function(){e.selectedOptions=[],e.unselectedOptions=e.resolvedOptions.slice()},e.toggleItem=function(a){"undefined"==typeof e.selectedOptions&&(e.selectedOptions=[]);var b=e.selectedOptions.indexOf(a),c=b!==-1;if(c)e.unselectedOptions.push(e.selectedOptions[b]),e.selectedOptions.splice(b,1);else if(!c&&(0===e.selectionLimit||e.selectedOptions.length<e.selectionLimit)){var d=e.unselectedOptions.indexOf(a);e.unselectedOptions.splice(d,1),e.selectedOptions.push(a)}},e.getId=function(b){return angular.isString(b)?b:angular.isObject(b)?e.idProp?a.getRecursiveProperty(b,e.idProp):(d.error("Multiselect: when using objects as model, a idProp value is mandatory."),""):b},e.getDisplay=function(b){return angular.isString(b)?b:angular.isObject(b)?e.displayProp?a.getRecursiveProperty(b,e.displayProp):(d.error("Multiselect: when using objects as model, a displayProp value is mandatory."),""):b},e.isSelected=function(a){if(!e.selectedOptions)return!1;for(var b=e.getId(a),c=0;c<e.selectedOptions.length;c++){var d=e.selectedOptions[c];if(e.getId(d)===b)return!0}return!1},e.updateOptions=function(){"function"==typeof e.options&&e.options().then(function(a){e.resolvedOptions=a,j()})},e.search=function(){var a=0;return function(b){if(a>e.searchLimit)return!1;var c=e.getDisplay(b);if(c){var d=c.toLowerCase().indexOf(e.searchFilter.toLowerCase())>-1;return d&&a++,d}}}}}}])}(),angular.module("btorfs.multiselect.templates",["multiselect.html"]),angular.module("multiselect.html",[]).run(["$templateCache",function(a){a.put("multiselect.html",'<div class="btn-group" style="width: 100%">\n    <button type="button" class="btn btn-default btn-block dropdown-toggle" ng-click="toggleDropdown()" ng-disabled="disabled">\n        {{getButtonText()}}&nbsp;<span class="caret"></span>\n    </button>\n    <ul class="dropdown-menu dropdown-menu-form"\n        ng-style="{display: open ? \'block\' : \'none\'}" style="width: 100%; overflow-x: auto">\n\n        <li ng-show="showSelectAll">\n            <a ng-click="selectAll()" href="">\n                <span class="glyphicon glyphicon-ok"></span> {{labels.selectAll || \'Select All\'}}\n            </a>\n        </li>\n        <li ng-show="showUnselectAll">\n            <a ng-click="unselectAll()" href="">\n                <span class="glyphicon glyphicon-remove"></span> {{labels.unselectAll || \'Unselect All\'}}\n            </a>\n        </li>\n        <li ng-show="(showSelectAll || showUnselectAll)"\n            class="divider">\n        </li>\n\n        <li role="presentation" ng-repeat="option in selectedOptions" class="active">\n            <a class="item-selected" href="" title="{{showTooltip ? getDisplay(option) : \'\'}}" ng-click="toggleItem(option); $event.stopPropagation()">\n                <span class="glyphicon glyphicon-remove"></span>\n                {{getDisplay(option)}}\n            </a>\n        </li>\n        <li ng-show="selectedOptions.length > 0" class="divider"></li>\n\n        <li ng-show="showSearch">\n            <div class="dropdown-header">\n                <input type="text" class="form-control input-sm" style="width: 100%;"\n                       ng-model="searchFilter" placeholder="{{labels.search || \'Search...\'}}" ng-change="updateOptions()"/>\n            </div>\n        </li>\n\n        <li ng-show="showSearch" class="divider"></li>\n        <li role="presentation" ng-repeat="option in unselectedOptions | filter:search() | limitTo: searchLimit"\n            ng-if="!isSelected(option)"\n            ng-class="{disabled : selectionLimit && selectedOptions.length >= selectionLimit}">\n            <a class="item-unselected" href="" title="{{showTooltip ? getDisplay(option) : \'\'}}" ng-click="toggleItem(option); $event.stopPropagation()">\n                {{getDisplay(option)}}\n            </a>\n        </li>\n\n        <li class="divider" ng-show="selectionLimit > 1"></li>\n        <li role="presentation" ng-show="selectionLimit > 1">\n            <a>{{selectedOptions.length || 0}} / {{selectionLimit}} {{labels.itemsSelected || \'selected\'}}</a>\n        </li>\n\n    </ul>\n</div>\n')}]);